\chapter{Формула Тейлора с остаточным членом в форме Пеано или Лагранжа.}
\section{Формула Тейлора с остаточным членом в форме Лагранжа}

Пусть функция $f(x)$ определена в некоторой окрестности точки $x_0$ и в точке $x_0$ имеет $n$-ю производную, а следовательно, и все производные до $n$-го порядка. Легко видеть, что многочлен
$$
P_n(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k
$$
обладает следующим свойством:
$$
P_n^{(k)}(x_0) = f^{(k)}(x_0) \quad \forall k = 0,1,\ldots,n.
$$
Этот многочлен называется \textit{многочленом Тейлора функции $f$ в точке $x_0$}.

Равенство $$f(x) = P_n(x) + r_n(x)$$ называется \textit{формулой Тейлора} для функции $f(x)$ в точке $x_0$, а функции $r_n(x)$ --- остаточным членом формулы Тейлора.

Замечание: В частном случае $x_0=0$ она называется \textit{формулой Маклорена}.

\begin{thm}
Если функция $f(x)$ в некоторой окрестности $O(x_0)$ точки $x_0$ имеет непрерывную производную $n$-го порядка и $f^{(n)}(x)$ дифференцируема в проколотой окрестности $\overset{\circ}{O}(x_0)$, то для любого
$x \in \overset{\circ}{O}(x_0)$ существует $\xi$, лежащее строго между $x$ и $x_0$ и такое, что справедливо равенство
\begin{equation} \label{ch5.1eq1}
f(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!}(x - x_0)^k + \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}.
\end{equation}
\end{thm}

\begin{proof}
Функции $$r_n(x) = f(x) - P_n(x) \quad \text{и} \quad \phi(x) = (x - x_0)^{n + 1}$$ удовлетворяют всем условиям следствия из теоремы Коши о среднем. Кроме того, $$r_n^{(k)}(x_0) = 0, \quad \phi^{(k)}(x_0) = 0 \quad \forall k = 0,1,\ldots,n.$$ Поэтому, если $x \in O(x_0)$ и, например, $x < x_0$, то существует $\xi_1 \in (x; x_0)$ такое, что
$$
\frac{r_n(x)}{\phi(x)} = \frac{r_n(x) - r_n(x_0)}{\phi(x) - \phi(x_0)} = \frac{r_n'(\xi_1)}{\phi'(\xi_1)}.
$$
Аналогично,
$$
\exists \xi_2 \in (\xi_1; x_0): \quad \frac{r_n'(\xi_1)}{\phi'(\xi_1)} = \frac{r_n''(\xi_2)}{\phi''(\xi_2)}.
$$

$$\ldots\ldots\ldots (\text{до тех пор пока есть производные})$$

$$
\exists \xi_n \in (\xi_{n - 1}; x_0): \quad \frac{r_n^{(n - 1)}(\xi_{n - 1})}{\phi^{(n - 1)}(\xi_{n - 1})} = \frac{r_n^{(n)}(\xi_{n})}{\phi^{(n)}(\xi_{n})}.
$$
Легко видеть, что 
$$
\phi^{(n)}(x) = (n + 1)!(x - x_0),
$$
$$
r_n^{(n)}(x) = f^{(n)}(x) - f^{(n)}(x_0).
$$

К этим функциям на отрезке $[\xi_n; x_0]$ снова применим теорему о среднем:
$$
\exists \xi \in (\xi_n; x_0): \quad \frac{r_n^{(n)}(\xi_{n})}{\phi^{(n)}(\xi_{n})} = \frac{r_n^{(n + 1)}(\xi)}{\phi^{(n + 1)}(\xi)} = \frac{f^{(n + 1)}(\xi)}{(n + 1)!}.
$$

Следовательно, $\exists \xi \in (x; x_0)$ такое, что
$$
\frac{r_n(x)}{\phi(x)} = \frac{f^{(n + 1)}(\xi)}{(n + 1)!},
$$
$$
r_n(x) = \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}.
$$

Аналогично рассматривается и случай $x > x_0$. Теорема доказана.
\end{proof}

Равенство $\eqref{ch5.1eq1}$ называется \textit{формулой Тейлоре с остаточным членом в форме Лагранжа}.

\begin{defn}
Функция, которая задается формулой 
$$
y = g(f(x)),
$$
где $f$ и $g$ --- данные функции, называется \textit{сложной функцией} или \textit{композицией} (иногда \textit{суперпозицией}) функций $f$ и $g$.
\end{defn}

\begin{thm}
Если функция $\phi(x)$ имеет предел при $x \to x_0$ и он равен $y_0$, а функция $f(y)$ имеет предел при $y \to y_0$ и, кроме того, $\forall x \in D_\phi \quad \phi(x) \in D_f, \: \phi(x) \not= y_0$, то сложная функция $f(\phi(x))$ имеет предел при $x \to x_0$ и
\begin{equation} \label{ch5.1eq3}
\lim_{x \to x_0} f(\phi(x)) = \lim_{y \to y_0} f(y).
\end{equation}
\end{thm}

\begin{proof}
Пусть последовательность $\{ x_n \}$ такая, что 
$$
\forall n \quad x_n \in D_{\phi}, \quad x_n \not= x_0 \quad \text{и} \quad \lim_{n \to \infty} x_n = x_0.
$$
Тогда последовательность $y_n = \phi(x_n)$ сходится к $y_0$ при $n \to \infty$ и 
$$
\lim_{n \to \infty} f(\phi(x_n)) = \lim_{n \to \infty} f(y_n) = \lim_{y \to y_0} f(y).
$$
Теорема доказана.
\end{proof}

Формула \eqref{ch5.1eq3} называется \textit{формулой замены переменного под знаком предела}. В ней $x_0$ и все рассматриваемые пределы могут быть как конечными, так и бесконечными.


\section{Формула Тейлора с остаточным членом в форме Пеано}

\begin{thm}
Если функция $f$ дифференцируема $n$ раз в точке $x_0 \in \bbR$, то справедливо равенство
\begin{equation} \label{ch5.2eq2}
f(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k + o((x - x_0)^n), \quad при x \to x_0,
\end{equation}
где $\psi(x) = o((x - x_0)^n), x \to x_0 \leftrightarrow \psi(x) = \alpha(x) (x - x_0)^n, \quad \text{где} \lim_{x \to x_0} \alpha(x) = 0$.

Формула $\eqref{ch5.2eq2}$ называется формулой Тейлора для $f$ в точке $x_0$ порядка $n$ с остаточным членом в форме Пеано
\end{thm}

\begin{proof}
Функция $f$ дифференцируема $n$ раз в точке $x_0$ $\quad \Rightarrow \quad f^{(n - 1)}(x)$ определена в некоторой окрестности $O(x_0)$ точки $x_0$, т.е. $\exists f^{(n)}(x_0) \in \bbR: \quad$
$ \exists f^{(k)}(x_0) \in \bbR, \quad \text{где} \quad k \in \overline{0,n - 1}$

Рассмотрим функции $r_n(x) = f(x) - P_n(x), \quad \phi(x) = (x - x_0)^n$
$$
r_n^{(k)}(x) = 0, \quad \forall k \in \overline{0,n}, \quad \phi^{(k)}(x_0) = 0, \quad \forall k \in \overline{0, n-1}, \quad \phi^{(k)}(x) \not= 0, \quad x \not= x_0.
$$ 

Согласно теореме Коши и следствию 5 из предыдущего билета все так же, как и в теореме 1 (про формулу Тейлора с остаточным членом в форме Лагранжа).

$\forall x \in \overset{\circ}{O}(x_0) \quad x < x_0 \quad \exists \xi = \xi(x) \in (x, x_0):$
$$
\frac{r_n(x)}{\phi(x)} = \frac{r_n^{(n-1)}(\xi)}{\phi^{(n-1)}(\xi)}
$$
$\forall x \in \overset{\circ}{O}(x_0) \quad \exists \xi \not= x_0:$
$$
\frac{r_n(x)}{\phi(x)} = \frac{r_n^{(n-1)}(\xi) - r_n^{(n-1)}(x_0)}{n!(\xi - x_0)}, \quad r_n^{(n-1)}(x_0) = 0 \Rightarrow
$$
$\xi = \xi(x): \quad \xi(x) < x_0 \quad \forall x \in O(x_0) \quad x < x_0$
$$
\lim_{n \to x_0} \xi(x) = x_0, \quad \text{т.к.} \quad x < \xi(x) < x_0 \quad \Rightarrow
$$
Теорема о замене переменной под знаком $\lim$ $\Rightarrow$
$$
\lim_{x \to x_0} \frac{r_n(x)}{\phi(x)} = \frac{1}{n!} \lim_{\xi \to x_0} \frac{r_n^{(n-1)}(\xi) - r_n^{(n-1)}(x_0)}{\xi - x_0} = \frac{1}{n!} r_n^{(n)}(x_0) = 0
$$
Функция $f(x) = \frac{r_n(x)}{\phi(x)}, \quad x \in \overset{\circ}{O}(x_0)$ --- бесконечно малая функция при $x \to x_0 \quad \Rightarrow r_n(x) = \phi(x)f(x) = (x - x_0)^n \cdot \alpha(x) = o((x - x_0)^n), \quad x \to x_0 \quad \Rightarrow \text{формула} \eqref{ch5.2eq2}$.
\end{proof}

\begin{thm}[о единственности разложения функции по формуле Тейлора]
Пусть функция $f$ дифференцируема $n$ раз в точке $x_0 \in \bbR$
\begin{equation} \label{ch5.3.eq3}
f(x) = \sum_{k = 0}^{n}a_k (x - x_0)^k + o((x - x_0)^n), \quad x \to x_0 
\end{equation}
Тогда $a_k = \frac{f^{(k)}(x_0)}{k!}, \quad \forall k \in \{0, 1, 2, \ldots,n\}$
\end{thm}

\begin{proof}
$f$ - дифференцируема $n$ раз в точке $x_0 \quad \Rightarrow$
Справедлива Формула Тейлора с остаточным членом в форме Пеано:
\begin{equation} \label{eq5.3eq4}
f(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!} \cdot (x - x_0)^k + o((x - x_0)^n) \quad \text{при} \quad x \to x_0
\end{equation}

Если из \eqref{ch5.3.eq3} вычесть \eqref{eq5.3eq4}, получим
\begin{equation} \label{eq5.3.eq5}
\sum\limits_{k = 0}^{n} \left( \frac{f^{(k)}(x_0)}{k!} - a_k \right) (x - x_0)^k = o((x - x_0)^n)
\end{equation}
В $\eqref{eq5.3.eq5}$ левая и правая часть имеют пределы при $x \to x_0$, которые равны между собой.
\end{proof}