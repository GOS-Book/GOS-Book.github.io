\chapter{Теоремы о среднем Ролля, Лагранжа и Коши для дифференцируемых функций.}\label{chapter4}

\section{Определение производной}

Пусть задана функция $f$ и точка $x_0\in D_f$. Тогда для любого $x \in D_f$, $x\ne x_0$, частное
\begin{equation}\label{ya3e1}
\frac{f(x)-f(x_0)}{x-x_0}=\frac{f(x_0+h)-f(x_0)}{h}, 
\end{equation}
где $h=x-x_0$, называется \textit{разностным отношением функции~$f$ в точке~$x_0$ с шагом $h$}.

\begin{defn}
\label{ya3d1}
Предел разностного отношения функции $f$ в точке $x_0 \in D_f$ с шагом $h$ при $h \to 0$ называется \textit{производной функции}\rindex{производная} $f$ в точке $x_0$ и обозначается $f'(x_0)$

\begin{equation}\label{ya3e2}
f'(x_0)=\lim_{h\to 0}\limits\frac{f(x_0+h)-f(x_0)}{h}=\lim_{x\to x_0}\limits \frac{f(x)-f(x_0)}{x-x_0}
\end{equation}

\end{defn}
\begin{defn} Предел разностного отношения функции $f$ в точке $x_0 \in D_f$ с шагом $h$ при $h \to +0 $ ($h \to -0$) называется \textit{правой (левой) производной функции} $f$ в точке $x_0$ и обозначается $f'_+(x_0)$ (соотв., $f'_-(x_0)$).
\begin{equation}\label{ya3e3}
f'_\pm(x_0)=\lim_{h\to \pm0}\limits\frac{f(x_0+h)-f(x_0)}{h}
\end{equation}
\end{defn}

Очевидно, функция, определенная в некоторой окрестности точки $x_0$, имеет производную в точке $x_0$ тогда и только тогда, когда она в $x_0$ имеет односторонние производные и эти производные равны.

Заметим, что пределы (2) и (3) могут быть как конечными, так и бесконечными, и поэтому можно говорить о конечных и бесконечных производных. 
\begin{defn} Функция $f$ называется \textit{дифференцируемой в точке}\rindex{функция!дифференцируемая} $x_0$, если она определена в некоторой окрестности точки $x_0$ и в этой точке имеет конечную производную.
\end{defn}
Формулы \eqref{ya3e2} и \eqref{ya3e3} часто записывают в других обозначениях. Вместо $x_0$ пишут $x$, шаг $h$ разностного отношения \eqref{ya3e1} обозначают $\Delta x$, и тогда	
\begin{equation}\label{ya3e4}
f'(x)=\lim_{\Delta x\to 0}\limits\frac{f(x+\Delta x)-f(x)}{\Delta x}
\end{equation}
Здесь $\Delta x$ называется приращением аргумента, а разность $f(x+\Delta x)-f(x)$ "--- соответствующим приращением функции. Если $y = f(x)$, то это приращение функции обозначают~$\Delta y$, а производную функции $f$ в точке $x$ обозначают~$y'$ В этих обозначениях формула~\eqref{ya3e4} принимает вид
$$
y'=\lim_{\Delta x \to 0}\limits \frac{\Delta y}{\Delta x}
$$
Аналогичным образом записываются и формулы \eqref{ya3e3}. В такой форме определение производной коротко формулируют так:
Производной называется предел отношения приращения функции к приращению аргумента, когда приращение аргумента стремится к нулю.	

\begin{defn}
Пусть $D'_f$ "--- множество точек, в которых функция $f$ имеет конечную производную. Тогда функция, которая каждому $x \in D'_f$ ставит в соответствие число $f'(x)$, называется \textit{производной} функции $y=f(x)$ и обозначается $f'$ или $y'$
\end{defn}
Операция нахождения производной данной функции $f$ называется \textit{дифференцированием функции} $f$.


\begin{defn}
Производная производной $f'$ функции $f$ в точке $x_0 \in D'_f$ называется \textit{второй производной} (или \textit{производной второго порядка}) \textit{функции $f$ в точке $x_0$} и обозначается $f''(x_0)$ или $f^{(2)}(x_0)$.
\end{defn}
Вообще, производная производной $f'$ функции $f$ называется \textit{второй производной} функции $y=f(x)$ и обозначается $f''$, $f^{(2)}$ или $y''$, $y^{(2)}$

\section{Теоремы о среднем Ролля, Лагранжа и Коши для дифференцируемых функций}
Пусть задана функция $f$, и пусть $x_0 \in D_f$, где $D_f$ "--- область определения функции $f$.
\begin{defn}
Точка $x_0 \in D_f$ называется \textit{точкой локального максимума (минимума) функции}~$f$, если существует окрестность $O(x_0)$ точки~$x_0$ такая, что для любого $x \in O(x_0)\cap D_f$ выполняется неравенство $f(x) \le f(x_0)$ (соотв., $f(x) \ge f(x_0)$).
\end{defn}
\begin{defn} Точки максимума и минимума функции называются ее \textit{точками экстремума}, а ее значения в этих точках "--- \textit{экстремальными значениями} (соотв., \textit{локальными максимумами} или \textit{локальными минимумами}).
\end{defn}
\begin{thm}[Ферма\rindex{теорема!Ферма}]\label{ch4n1} 
Если функция $f$ дифференцируема в точке $x_0$ и $x_0$ является ее точкой экстремума, то $f'(x_0) = 0$.
\end{thm}
\begin{proof}
Прежде всего заметим, что функция $f$ определена в некоторой окрестности точки~$x_0$, так как она дифференцируема в точке~$x_0$. Пусть, например, $x_0$ "--- точка максимума функции $f$. Тогда существует окрестность $O(x_0)$ точки $x_0$ такая, что 
$$
f(x) \le f(x_0)\quad \forall x \in O(x_0),
$$
и поэтому если $x \in O(x_0)$ и $x < x_0$ (соотв., $x > x_0$), то
$$
\frac{f(x)-f(x_0)}{x-x_0}\ge0\ (\le 0).
$$
Следовательно,
$$
f'_{-}(x_0)\ge 0, \quad f'_{+}(x_0)\le 0
$$
а так как эти односторонние производные равны производной $f'(x_0)$,
то $f'(x_0) = 0$. 

Случай, когда $x_0$ "--- точка минимума, рассматривается аналогично. 

Теорема доказана.
\end{proof}

Теорема Ферма имеет простую геометрическую интерпретацию:	если функция $y = f(x)$ дифференцируема в точке $x_0$ и $x_0$ "--- ее точка экстремума, то касательная к графику этой функции в точке $x_0$ параллельна оси $Ox$. 

\begin{defn}
Функция $f(x)$ называется \textit{дифференцируемой на интервале}\rindex{функция!дифференцируемая} $(a;b)$, если она определена на $(a;b)$ и в каждой его точке имеет конечную производную.
\end{defn}

\begin{thm} [Ролля\rindex{теорема!Ролля}] Если функция $f(x)$ непрерывна на отрезке $[a; b]$, дифференцируема на интервале $(a; b)$ и $f(a) = f(b)$, то существует $\xi \in (a; b)$ такое, что $f'(\xi) = 0$.
\end{thm}
\begin{proof}
По теореме~\hyperref[{th:ch2:Veyershtrass}]{Вейерштрасса} (глава~\textnumero\ref{chapter2}) Функция~$f(x)$ на отрезке $[a;b]$ принимает и наибольшее и наименьшее значения, а так как $f(a) = f(b)$, то одно из них она принимает в некоторой точке $\xi \in (a; b)$. Тогда из  \hyperref[ch4n1]{теоремы Ферма} следует, что $f'(\xi) = 0$.
 
Теорема доказана.
\end{proof}

\begin{thm}[Лагранжа\rindex{теорема!Лагранжа}]\label{ch4t1} Если функция $f(x)$ непрерывна на отрезке $[a; b]$ и дифференцируема на интервале $(a; b)$, то существует $\xi \in (a; b)$ такое, что
\begin{equation}\label{ch4e1}
\frac{f(b)-f(a)}{b-a}=f'(\xi)
\end{equation}
\end{thm}

\begin{proof} Рассмотрим функцию $F(x) = f(x) - \lambda x$ и найдем $\lambda$ из условия $F(a) = F(b)$. Тогда
\begin{equation}\label{ch4e2}
\lambda=\frac{f(b)-f(a)}{b-a}
\end{equation}

Функция $F(x)$ при таком $\lambda$ удовлетворяет всем условиям теоремы Ролля, поэтому существует $\xi \in (a; b)$ такое, что $F'(\xi) = 0$. А так как $F'(x) = f'(x) - \lambda$, то $f'(\xi) = \lambda$, т.е. выполняется равенство~\eqref{ch4e1}.
 
Теорема доказана.
\end{proof}
Заметим, что коэффициент $\lambda$, определяемый по формуле~\eqref{ch4e2}, равен угловому коэффициенту хорды, проходящей через точки $A(a;f(a))$ и $B(b;f(b))$. Следовательно, теорема Лагранжа утверждает существование точки, в которой касательная к графику функции $f$ параллельна этой хорде.
\begin{cons} 
Если функция $f(x)$ непрерывна в некоторой окрестности $O(x_0)$ точки $x_0$ и дифференцируема в проколотой
окрестности $\dnei{x_0}$, то для любого $x \in \dnei{x_0}$ существует $\xi$ лежащее строго между $x$ и $x_0$ и такое, что
\begin{equation}\label{ch4e3}
f(x)-f(x_0)=f'(\xi)(x-x_0).
\end{equation}
\end{cons}

Формула \eqref{ch4e3} называется \textit{формулой Лагранжа} для конечных приращений или \textit{формулой конечных приращений}.
Это следствие можно интерпретировать несколько иначе:

\begin{cons}
Если функция $f$ непрерывна в $O(x_0)$ и дифференцируема в $\dnei{x_0}$, то $\forall x \in \dnei{x_0}$ $\exists \Theta \in (0;1)$:
$$
f(x) - f(x_0) = f'(x_0 + \Theta\Delta x)\Delta x,
$$
где $\Delta x=x-x_0$.
\end{cons}

\begin{cons}
Если функция $f$ непрерывна на отрезке $[a; b]$, дифференцируема на интервале $(a;b)$ и $f'(x) = 0$ $\forall x \in (a;b)$, то функция $f$ постоянна на отрезке $[a; b]$.	
\end{cons}

\begin{defn}Функция называется \textit{кусочно-дифференцируемой} на некотором промежутке, если она всюду, кроме конечного числа точек, имеет конечную производную.
\end{defn}

\begin{cons} Если функция непрерывна на некотором конечном или бесконечном промежутке и всюду, кроме конечного числа точек, имеет производную, равную нулю, то эта функция постоянна на рассматриваемом промежутке.
\end{cons}

\begin{thm} [Коши\rindex{теорема!Коши}] Если функции $f(x)$ и $g(x)$ непрерывны на отрезке~$[a; b]$, дифференцируемы на интервале $(a; b)$ и $g'(x) \ne 0$ на $(a; b)$, то существует $\xi \in (a; b)$ такое, что
\begin{equation}
\label{ch4e4}
\frac{f(b)-f(a)}{g(b)-g(a)}=\frac{f'(\xi)}{g'(\xi)}.
\end{equation}
\end{thm}

\begin{proof} Так как $g'(x) \ne 0$ на $(a,b)$, то $g(b)\ne g(a)$ (по теореме Ролля). Рассмотрим функцию $F(x) =f(x) - \lambda g(x)$ и найдем $\lambda$ из условия $F(a) = F(b)$. Тогда
$$
\lambda = \frac{f(b)-f(a)}{g(b)-g(a)}
$$

Функция $F(x)$ при таком $\lambda$ удовлетворяет всем условиям теоремы Ролля, поэтому существует $\xi \in (a; b)$ такое, что $F'(\xi) = 0$. А так как $F'(x) = f'(x) - \lambda g'(x)$, то $f'(\xi) = \lambda g'(\xi)$, т.е. выполняется равенство \eqref{ch4e4}.

Теорема доказана.
\end{proof}

\begin{cons} \label{ch4.1cons5}
	Если функции $f(x)$ и $g(x)$ непрерывны в некоторой окрестности $O(x_0)$ точки $x_0$ и дифференцируемы в проколотой
окрестности $\dnei{x_0}$, причем $g'(x) \ne 0$ в  $\dnei{x_0}$, то  для любого $x \in  \dnei{x_0}$ существует $\xi$, лежащее строго между $x$ и $x_0$ такое, что
$$
\frac{f(x)-f(x_0)}{g(x)-g(x_0)}=\frac{f'(\xi)}{g'(\xi)}.
$$
\end{cons}